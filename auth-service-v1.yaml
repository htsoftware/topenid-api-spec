openapi: 3.0.1
info:
  title: Auth service
  version: v1
servers:
  - url: Please follow the release note for further information
tags:
  - name: Authentication APIs
    description: Group of APIs to authenticate users and relying parties
  - name: Access Session APIs
    description: Group of APIs to manage session access
  - name: Account Management APIs
    description: Group of APIs to manage account
paths:
  "/client-access-token":
    post:
      tags:
        - Authentication APIs
      summary: Generate client access token
      description: "This API is used to generate client access token. \n When granting a new client access token, all old access tokens will invalid. Should keep the token unique in the system."
      operationId: generateClientToken
      parameters:
        - name: Client-Id
          in: header
          required: true
          schema:
            type: string
        - name: Client-Secret
          in: header
          required: true
          schema:
            type: string
      responses:
        '201':
          description: CREATED
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/ClientTokenResponse"
              examples:
                client_access_token:
                  summary: client access token
                  value:
                    message: The request completed successfully
                    status: SUCCESS
                    code:
                    data:
                      access_token: eyJ4NXQiOiJNell4TW1Ga09HWXdNV0kwWldObU5EY3hO...
                      expires_in: 3600
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                client_id_missing:
                  summary: Missing request header 'Client-Id' for method parameter
                    of type String
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Id' for method parameter
                      of type String
                client_secret_missing:
                  summary: Missing request header 'Client-Secret' for method parameter
                    of type String
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Secret' for method parameter
                      of type String
                client_id_blank:
                  summary: client_id cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: client_id cannot be blank
                client_secret_blank:
                  summary: client_secret cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: client_secret cannot be blank
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                invalid_client_credential:
                  summary: Invalid client credentials
                  value:
                    data:
                    status: FAILURE
                    code: '203012'
                    message: Invalid client credentials
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/introspect":
    post:
      tags:
        - Authentication APIs
      summary: Validate an access_token
      description: This API is used to validate an access_token whether it is valid or not.
      operationId: introspectToken
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/IntrospectRequest"
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/IntrospectResponse"
              example:
                code:
                data:
                  exp:
                  username: string
                  active: true
                  token_type: string
                  client_id: string
                  iat:
                message:
                status: SUCCESS
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                token_blank:
                  summary: token cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: token cannot be blank
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/configurations/locking-account":
    post:
      tags:
        - Account Management APIs
      security:
        - bearerAuth: []
      summary: Account Locking Configuration
      description: "Account Locking Configuration:\n 1. Enable status check lock account.
        \n 2. Config Maximum Failed Login Attempts (Null is the default value). \n
        3. Config Seconds Locking time period (Null is the default value). \n\n **
        This API requires Relying Party Access Token."
      operationId: lockingConfiguration
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/AccountLockingConfigurationRequest"
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/AccountLockingConfigurationResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                account_lock_enabled_not_blank:
                  summary: account_lock_enabled cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: account_lock_enabled cannot be blank
                Invalid_account_lock_enabled_format:
                  summary: Invalid account_lock_enabled format
                  value:
                    data:
                    status: FAILURE
                    code: '200002'
                    message: Invalid account_lock_enabled format
                Invalid_maximum_failed_login_attempts_format:
                  summary: Invalid maximum_failed_login_attempts format
                  value:
                    data:
                    status: FAILURE
                    code: '200002'
                    message: Invalid maximum_failed_login_attempts format
                maximum_failed_login_attempts_over_max_zero:
                  summary: maximum_failed_login_attempts value was gone over the max
                    value or equal zero (= 0)
                  value:
                    data:
                    status: FAILURE
                    code: '200008'
                    message: maximum_failed_login_attempts must be greater than 0
                      and smaller or equal to <maximum value>
                Invalid_account_unlock_time_format:
                  summary: Invalid account_unlock_time format
                  value:
                    data:
                    status: FAILURE
                    code: '200002'
                    message: Invalid account_unlock_time format
                account_unlock_time_over_max_zero:
                  summary: account_unlock_time value was gone over the max value or
                    equal zero (= 0)
                  value:
                    data:
                    status: FAILURE
                    code: '200008'
                    message: account_unlock_time must be greater than 0 and smaller
                      or equal to <maximum value>
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/accounts/{ht_id}/block":
    post:
      tags:
        - Account Management APIs
      security:
        - bearerAuth: []
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: ht_id
          in: path
          required: true
          schema:
            type: string
      summary: Block an account for a reason
      operationId: blockAccount
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/BlockAccountRequest"
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/BlockAccountResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id_blank:
                  summary: ht_id is blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: ht_id cannot be blank
                reason_blank:
                  summary: reason is blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: reason cannot be blank
                reason_too_long:
                  summary: reason too long
                  value:
                    data:
                    status: FAILURE
                    code: '200004'
                    message: reason's length must be less than 501
                account_has_been_blocked:
                  summary: account has been blocked
                  value:
                    data:
                    status: FAILURE
                    code: '203028'
                    message: This account has been blocked
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '404':
          description: Not found
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id_cannot_found:
                  summary: ht_id cannot be found
                  value:
                    data:
                    status: FAILURE
                    code: '202007'
                    message: ht_id cannot be found
                ht_id_is_empty:
                  summary: ht_id is empty
                  value:
                    data:
                    status: FAILURE
                    code: '200007'
                    message: The requested resource cannot be found
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/accounts/{ht_id}/unblock":
    put:
      tags:
        - Account Management APIs
      security:
        - bearerAuth: []
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: ht_id
          in: path
          required: true
          schema:
            type: string
      summary: Unblock an account for a reason
      operationId: unblockAccount
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/UnblockAccountRequest"
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/UnblockAccountResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id_blank:
                  summary: ht_id is blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: ht_id cannot be blank
                reason_blank:
                  summary: reason is blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: reason cannot be blank
                reason_too_long:
                  summary: reason too long
                  value:
                    data:
                    status: FAILURE
                    code: '200004'
                    message: reason's length must be less than 501
                account_not_blocked:
                  summary: account was not blocked
                  value:
                    data:
                    status: FAILURE
                    code: '203026'
                    message: This account wasn't blocked
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '404':
          description: Not found
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id_cannot_found:
                  summary: ht_id cannot be found
                  value:
                    data:
                    status: FAILURE
                    code: '202007'
                    message: ht_id cannot be found
                ht_id_is_empty:
                  summary: ht_id is empty
                  value:
                    data:
                    status: FAILURE
                    code: '200007'
                    message: The requested resource cannot be found
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/accounts/{ht_id}/unlock":
    put:
      tags:
        - Account Management APIs
      security:
        - bearerAuth: []
      operationId: unlockAccount
      summary: Unlock account manually
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: ht_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/UnlockAccountResponse"
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id cannot be blank:
                  summary: ht_id cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: ht_id cannot be blank
                account_was_not_locked:
                  summary: ht_id wasn't locked
                  value:
                    data:
                    code: '203029'
                    status: FAILURE
                    message: This account wasn't locked
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '404':
          description: Not found
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id_cannot_found:
                  summary: ht_id cannot be found
                  value:
                    data:
                    status: FAILURE
                    code: '202007'
                    message: ht_id cannot be found
                ht_id_is_empty:
                  summary: ht_id is empty
                  value:
                    data:
                    status: FAILURE
                    code: '200007'
                    message: The requested resource cannot be found
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/configurations/access-session":
    get:
      tags:
        - Access Session APIs
      security:
        - bearerAuth: []
      operationId: fetchAccessSessionConfiguration
      summary: Retrieve Access Session Configuration
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/AccessSessionConfigurationResponse"
              examples:
                success:
                  summary: The request completed successfully
                  value:
                    message: The request completed successfully
                    status: SUCCESS
                    code:
                    data:
                      max_active_session: 1
                      channel_dependency: true
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
    post:
      tags:
        - Access Session APIs
      security:
        - bearerAuth: []
      summary: Access Session Configuration
      description: "Access Session Configuration:\n 1. Max active session: The maximum
        number of allowed active sessions \n 2. Channel dependency: \n+ True = Per
        channel (Web browser, Mobile app): Default value\n+ False = All channels"
      operationId: accessSessionConfiguration
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/AccessSessionConfigurationRequest"
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/AccessSessionConfigurationResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                max_active_session_invalid_format:
                  summary: max_active_session_invalid_format
                  value:
                    data:
                    status: FAILURE
                    code: '200002'
                    message: Invalid max_active_session format
                max_active_session_over_max_range:
                  summary: max_active_session_over_max_range
                  value:
                    data:
                    status: FAILURE
                    code: '200008'
                    message: max_active_session must be greater than 0 and smaller
                      or equal to 10
                channel_dependency_invalid_format:
                  summary: channel_dependency_invalid_format
                  value:
                    data:
                    status: FAILURE
                    code: '200002'
                    message: Invalid channel_dependency format
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/access-session":
    post:
      tags:
        - Access Session APIs
      summary: Get access session
      description: Get new access session with user's credentials.
      operationId: getAccessSession
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: Client-Id
          in: header
          required: true
          schema:
            type: string
        - name: Client-Secret
          in: header
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/AccessSessionRequest"
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/AccessSessionResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                client_id_missing:
                  summary: Missing request header 'Client-Id'
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Id' for method parameter
                      of type String
                client_secret_missing:
                  summary: Missing request header 'Client-Secret'
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Secret' for method parameter
                      of type String
                username_blank:
                  summary: username blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: username cannot be blank
                password_blank:
                  summary: password blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: password cannot be blank
                access_channel_blank:
                  summary: access_channel blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: access_channel cannot be blank
                access_channel_not_support:
                  summary: access_channel not supported
                  value:
                    data:
                    status: FAILURE
                    code: '200003'
                    message: access_channel isn't in supported list
                account_un_active:
                  summary: un-activated user account
                  value:
                    data:
                    status: FAILURE
                    code: '203011'
                    message: Cannot authenticate an un-activated user account
                account_is_locked:
                  summary: account is locked
                  value:
                    data:
                      unlock_time: 1625454349735
                    status: FAILURE
                    code: '203027'
                    message: This account has been locked
                account_is_blocked:
                  summary: account is blocked
                  value:
                    data:
                    status: FAILURE
                    code: '203028'
                    message: This account has been blocked
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                invalid_user_credential:
                  summary: Invalid user credentials
                  value:
                    data:
                    status: FAILURE
                    code: '203010'
                    message: Invalid user credentials
                invalid_client_credential:
                  summary: Invalid client credentials
                  value:
                    data:
                    status: FAILURE
                    code: '203012'
                    message: Invalid client credentials
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                invalid_consent_receipt:
                  summary: lack of valid consent receipt
                  value:
                    data:
                    status: FAILURE
                    code: '203032'
                    message: Lack of valid consent receipt
                password_expired:
                  summary: password expired
                  value:
                    data:
                    status: FAILURE
                    code: '202008'
                    message: The password has expired
                account_is_blocked_by_topenid:
                  summary: Account has been blocked by TopenID
                  value:
                    data:
                    status: FAILURE
                    code: '203033'
                    message: The account has been blocked
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/refreshed-access-session":
    post:
      tags:
        - Access Session APIs
      summary: Exchange refresh token for an active access session
      description: This API is used when a new access token is needed without user credentials.
      operationId: getRefreshedAccessSession
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: Client-Id
          in: header
          required: true
          schema:
            type: string
        - name: Client-Secret
          in: header
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/RefreshAccessSessionRequest"
        required: true
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/AccessSessionResponse"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                client_id_missing:
                  summary: Missing request header 'Client-Id'
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Id' for method parameter
                      of type String
                client_secret_missing:
                  summary: Missing request header 'Client-Secret'
                  value:
                    data:
                    status: FAILURE
                    code: '203024'
                    message: Missing request header 'Client-Secret' for method parameter
                      of type String
                refresh_token_blank:
                  summary: refresh_token blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: refresh_token cannot be blank
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                invalid_user_credential:
                  summary: Invalid refresh token
                  value:
                    data:
                    status: FAILURE
                    code: '203014'
                    message: Invalid refresh token
                invalid_client_credential:
                  summary: Invalid client credentials
                  value:
                    data:
                    status: FAILURE
                    code: '203012'
                    message: Invalid client credentials
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                password_expired:
                  summary: password expired
                  value:
                    data:
                    status: FAILURE
                    code: '202008'
                    message: The password has expired
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/sessions/{session_id}":
    delete:
      security:
        - bearerAuth: []
      tags:
        - Access Session APIs
      summary: Revoke access session
      description: Revoke access session by sessionId.
      operationId: revokeAccessSession
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {user access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: session_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        type: object
                        nullable: true
                        example:
              examples:
                update_successful:
                  summary: revoke successful
                  value:
                    data:
                    message: The request completed successfully
                    code:
                    status: SUCCESS
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                session_id_blank:
                  summary: session_id blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: session_id cannot be blank
                session_id_not_found:
                  summary: session_id not found
                  value:
                    data:
                    status: FAILURE
                    code: '202002'
                    message: session_id cannot be found
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/active-access-sessions":
    get:
      tags:
        - Access Session APIs
      security:
        - bearerAuth: []
      operationId: fetchActiveAccessSessions
      summary: Retrieve List of Active Access Sessions with an access token
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {user access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data:
                        "$ref": "#/components/schemas/ActiveAccessSessionResponse"
              examples:
                success:
                  summary: The request completed successfully
                  value:
                    message: The request completed successfully
                    status: SUCCESS
                    code:
                    data:
                      ht_id: '2828917688328040'
                      sessions:
                        - session_id: string
                          access_time: 1625454349735
                          access_channel: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
  "/accounts/{ht_id}":
    delete:
      tags:
        - Account Management APIs
      security:
        - bearerAuth: [ ]
      operationId: removeBlockedAccount
      summary: Remove a blocked account
      description: This API allows RP remove a blocked account
      parameters:
        - name: Client-Token
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer {client access token}
        - name: lang
          in: query
          schema:
            type: string
          description: lang=vi or lang=en (If lang is missing, the default vi language will be return)
        - name: ht_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - "$ref": "#/components/schemas/ResponseData"
                  - type: object
                    properties:
                      data: { }
              examples:
                default:
                  summary: The request completed successfully
                  value:
                    message: The request completed successfully
                    status: SUCCESS
                    code:
                    data:
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                ht_id cannot be blank:
                  summary: ht_id cannot be blank
                  value:
                    data:
                    status: FAILURE
                    code: '200001'
                    message: ht_id cannot be blank
                ht_id_not_found:
                  summary: ht_id not found
                  value:
                    data:
                    status: FAILURE
                    code: '202002'
                    message: ht_id cannot be found
                block_account_time_is_greater_than_minimize:
                  summary: The account isn't enough the blocking time to remove
                  value:
                    data:
                    status: FAILURE
                    code: '203039'
                    message: The account {ht_id} isn't enough the blocking time to remove
                cannot_remove_account_not_being_blocked_all_RPs:
                  summary: Cannot remove an account not being blocked at all RPs
                  value:
                    data:
                    status: FAILURE
                    code: '203040'
                    message: The account {ht_id} cannot remove
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: Invalid access token
                code: '203015'
                status: FAILURE
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              examples:
                Access denied:
                  summary: Access denied
                  value:
                    data:
                    message: Access denied
                    code: '203016'
                    status: FAILURE
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                message: ht_id cannot be found
                code: '202007'
                status: FAILURE
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ErrorResponseData"
              example:
                data:
                code: '100500'
                status: FAILURE
                message: Error detail message
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ResponseData:
      type: object
      properties:
        message:
          type: string
          nullable: true
          example:
        status:
          type: string
          example: SUCCESS
          enum:
            - SUCCESS
            - FAILURE
        code:
          type: string
          nullable: true
          example:
    TokenRequest:
      type: object
      required:
        - scope
        - grant_type
      properties:
        username:
          type: string
          example: dat
        password:
          type: string
          example: dat@12345
        scope:
          type: string
          example: openid
        grant_type:
          type: string
          enum:
            - password
            - client_credentials
            - refresh_token
          example: password
        refresh_token:
          type: string
          example: dfhguHSDFSDIsugdsjkKDJFGDFKJ
    IntrospectRequest:
      type: object
      required:
        - token
      properties:
        token:
          type: string
          example: dat
          description: user access token or TopenX user access token
    IntrospectResponse:
      type: object
      required:
        - username
        - active
        - token_type
        - client_id
        - iat
      properties:
        code:
          type: string
        data:
          type: object
          properties:
            exp:
              type: integer
              format: int32
              nullable: true
            username:
              type: string
            active:
              type: boolean
            token_type:
              type: string
            client_id:
              type: string
            iat:
              type: integer
              format: int32
              nullable: true
        message:
          type: string
        status:
          type: string
          enum:
            - SUCCESS
            - FAILURE
      title: Response
    ClientTokenResponse:
      type: object
      properties:
        access_token:
          type: string
        expires_in:
          type: integer
          format: int32
      title: Response
    ErrorResponseData:
      type: object
      properties:
        data:
          type: object
          nullable: true
          example:
          description: Data is null when we got an error.
        message:
          type: string
          description: Information detail of status
          example: Internal server error
        status:
          type: string
          enum:
            - FAILURE
        code:
          type: string
          description: TBD, error code of detail error
          example: '100500'
    BlockAccountRequest:
      type: object
      required:
        - reason
      properties:
        reason:
          type: string
          maxLength: 500
          example: String
    BlockAccountResponse:
      type: object
      properties:
        ht_id:
          type: string
          example: 2234949241839324
        locked:
          type: boolean
          example: false
        blocked:
          type: boolean
          example: true
        active:
          type: boolean
          example: true
        last_modified_date:
          type: integer
          format: int64
          example: 1625454349735
          description: Unix timestamps in miliseconds.
        reason:
          type: string
          maxLength: 500
          example: string
          description: blocking/unblocking reason.
    AccountLockingConfigurationRequest:
      type: object
      required:
        - account_lock_enabled
      properties:
        account_lock_enabled:
          type: boolean
          example: true
        maximum_failed_login_attempts:
          type: integer
          example: 5
        account_unlock_time:
          type: integer
          example: 300
          description: Seconds
    AccountLockingConfigurationResponse:
      type: object
      properties:
        client_id:
          type: string
        account_lock_enabled:
          type: boolean
          example: true
        maximum_failed_login_attempts:
          type: integer
          example: 5
        account_unlock_time:
          type: integer
          example: 300
    UnlockAccountResponse:
      type: object
      properties:
        ht_id:
          type: string
          example: 2234949241839324
        locked:
          type: boolean
          example: false
        blocked:
          type: boolean
          example: false
        active:
          type: boolean
          example: true
    UnblockAccountRequest:
      type: object
      required:
        - reason
      properties:
        reason:
          type: string
          maxLength: 500
          example: String
    UnblockAccountResponse:
      type: object
      properties:
        ht_id:
          type: string
          example: 2234949241839324
        locked:
          type: boolean
          example: false
        blocked:
          type: boolean
          example: true
        active:
          type: boolean
          example: true
        last_modified_date:
          type: integer
          format: int64
          example: 1625454349735
          description: Unix timestamps in miliseconds.
        reason:
          type: string
          maxLength: 500
          example: string
          description: blocking/unblocking reason.
    AccessSessionConfigurationRequest:
      type: object
      required:
        - max_active_session
        - channel_dependency
      properties:
        max_active_session:
          type: integer
          example: 1
        channel_dependency:
          type: boolean
          example: true
    AccessSessionConfigurationResponse:
      type: object
      properties:
        max_active_session:
          type: integer
          example: 1
        channel_dependency:
          type: boolean
          example: true
    RefreshAccessSessionRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string
          example: 6184441f-64b0-32d7-891f-10e0db6bfb14
    AccessSessionResponse:
      type: object
      properties:
        code:
          type: string
        data:
          type: object
          properties:
            access_token:
              type: string
              example: 6184441f-64b0-32d7-891f-10e0db6bfb14
            refresh_token:
              type: string
              example: 6184441f-64b0-32d7-891f-10e0db6bfb14
            id_token:
              type: string
              example: 6184441f-64b0-32d7-891f-10e0db6bfb14
            token_type:
              type: string
              example: Bearer
            session_id:
              type: string
              example: 6184441f-10e0db6bfb14
            access_channel:
              type: string
              example: Mobile
            access_time:
              type: integer
              format: int64
              example: 1625454349735
              description: Unix timestamps in miliseconds.
            password_expiry_date:
              type: integer
              format: int64
              example: 1625454343452
              description: Unix timestamps in miliseconds.
        message:
          type: string
        status:
          type: string
          enum:
            - SUCCESS
            - FAILURE
    ActiveAccessSessionResponse:
      type: object
      properties:
        ht_id:
          type: string
        sessions:
          type: array
          items:
            "$ref": "#/components/schemas/ActiveAccessSessionDto"
    ActiveAccessSessionDto:
      type: object
      properties:
        session_id:
          type: string
        access_time:
          type: integer
          format: int64
          example: 1625454349735
          description: Unix timestamps in miliseconds.
        access_channel:
          type: string
    AccessSessionRequest:
      type: object
      required:
        - username
        - password
        - access_channel
      properties:
        username:
          type: string
          example: 91111111
        password:
          type: string
          example: abcd1234
        access_channel:
          type: string
          enum:
            - Mobile
            - Web
        consent_receipt:
          type: array
          items:
            type: string
          description: A list of consent purpose ID of RP
          example:
            - '2234949241839324'

